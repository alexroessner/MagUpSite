# ARCHITECTURE CLARITY
## Understanding the DeckSiteAgent ↔ MagUpSite Relationship

**Created:** 2026-02-11
**Status:** ✅ Definitive

---

## THE CORRECT MENTAL MODEL

### DeckSiteAgent = The Factory
- **What it is:** A reusable, white-label content generation engine
- **What it does:** Transforms input documents (PDFs, data) into professional output (websites, decks, presentations)
- **How it works:** Two-stream pipeline → merge → build → deploy
- **Key characteristic:** **Product, not project** — designed for multiple clients, multiple use cases

### MagUpSite = The First Product Off the Assembly Line
- **What it is:** The GEO 42 marketing site (deployed at `alexroessner.github.io/MagUpSite`)
- **What it does:** Showcases the GEO 42 methodology and converts visitors to clients
- **How it was made:** Generated by DeckSiteAgent from source materials
- **Key characteristic:** **Pilot, not platform** — the proof-of-concept that validates the engine

---

## THE CRITICAL INSIGHT

**MagUpSite is NOT a separate codebase.**

It's the output of running DeckSiteAgent with specific inputs:
- Input PDF: Company materials, methodology docs
- Reference URL: Design system to clone
- Whitelabel config: GEO 42 brand settings
- Output: Static site at `/dist` → deployed to GitHub Pages

### This means:

```
┌─────────────────────────────────────────────────────┐
│ DeckSiteAgent (The Engine)                          │
│                                                      │
│  ┌────────────────────────────────────────┐         │
│  │ Pipeline                               │         │
│  │  • PDF extraction                      │         │
│  │  • Style scraping                      │         │
│  │  • Merge + synthesis                   │         │
│  │  • Eleventy build                      │         │
│  └────────────────────────────────────────┘         │
│                                                      │
│  ┌────────────────────────────────────────┐         │
│  │ 11 Personas                            │         │
│  │  • Document analyst                    │         │
│  │  • Style cloner                        │         │
│  │  • Brand interpreter                   │         │
│  │  • Content architect                   │         │
│  │  • Copywriter                          │         │
│  │  • Synthesizer                         │         │
│  │  • Engineer                            │         │
│  │  • Accessibility specialist            │         │
│  │  • SEO specialist                      │         │
│  │  • 3D graphics specialist              │         │
│  │  • Target audience (dynamic)           │         │
│  └────────────────────────────────────────┘         │
│                                                      │
│  ┌────────────────────────────────────────┐         │
│  │ Template System (src/)                 │         │
│  │  • base.njk (master layout)            │         │
│  │  • index.njk (homepage)                │         │
│  │  • about.njk, services.njk, etc.       │         │
│  │  • style-guide.njk                     │         │
│  └────────────────────────────────────────┘         │
│                                                      │
│  ┌────────────────────────────────────────┐         │
│  │ Configuration                          │         │
│  │  • whitelabel.config.js                │         │
│  │  • src/css/input.css (@theme)          │         │
│  └────────────────────────────────────────┘         │
└─────────────────────────────────────────────────────┘
                        │
                        │ INPUT (for pilot)
                        │ • PDF: GEO 42 materials
                        │ • URL: Reference design
                        │ • Config: GEO 42 brand
                        ▼
                   ┌─────────┐
                   │ npm run │
                   │ pipeline│
                   └─────────┘
                        │
                        ▼
                   ┌─────────┐
                   │  dist/  │ ─────────────┐
                   └─────────┘              │
                        │                   │
                        │                   │ DEPLOY
                        ▼                   │
            ┌───────────────────────┐       │
            │ MagUpSite (Output #1) │◄──────┘
            │                       │
            │ GEO 42 marketing site │
            │ @ alexroessner.github │
            │   .io/MagUpSite       │
            └───────────────────────┘


Future outputs:
┌────────────────────────┐
│ ClientSite #2          │  (same engine, different inputs)
└────────────────────────┘

┌────────────────────────┐
│ ClientSite #3          │  (same engine, different inputs)
└────────────────────────┘

┌────────────────────────┐
│ InvestorDeck #1        │  (same engine, pitch deck template)
└────────────────────────┘
```

---

## ARCHITECTURAL IMPLICATIONS

### 1. DeckSiteAgent Must Be Generalizable

**Current State:**
- ✅ Uses `whitelabel.config.js` for brand settings (good!)
- ✅ Has persona-based quality control (good!)
- ✅ PDF extraction is content-agnostic (good!)
- ❌ Some GEO 42-specific content in templates (needs fixing)
- ❌ No multi-project support (one config at a time)
- ❌ No template versioning or variants

**What Needs to Change:**

#### Remove GEO 42 Hardcoding
Audit all templates (`src/**/*.njk`) for:
- Hardcoded "GEO 42" references
- Industry-specific assumptions
- Tone/voice that's not configurable
- Layout patterns that assume specific content

**Solution:** Move all specificity to `whitelabel.config.js` and `src/_data/pageContent.json`

#### Support Multiple Clients
```
DeckSiteAgent/
├── clients/                        # NEW
│   ├── geo42/
│   │   ├── whitelabel.config.js
│   │   ├── source-pdf/
│   │   ├── data/
│   │   └── dist/ → deploy to MagUpSite
│   ├── client-alpha/
│   │   ├── whitelabel.config.js
│   │   ├── source-pdf/
│   │   ├── data/
│   │   └── dist/ → deploy to client-alpha.com
│   └── client-beta/
│       ├── whitelabel.config.js
│       ├── source-pdf/
│       ├── data/
│       └── dist/ → deploy to client-beta.io
├── src/                           # Templates (shared)
├── personas/                      # Personas (shared)
├── scripts/                       # Pipeline (shared)
└── package.json
```

**Commands become:**
```bash
npm run pipeline -- --client geo42
npm run pipeline -- --client client-alpha
npm run dev -- --client geo42
```

#### Support Template Variants
```
DeckSiteAgent/
├── templates/                     # NEW
│   ├── marketing-site/
│   │   ├── src/
│   │   ├── eleventy.config.js
│   │   └── README.md
│   ├── pitch-deck/
│   │   ├── src/
│   │   ├── reveal.config.js
│   │   └── README.md
│   ├── board-deck/
│   └── sales-deck/
├── clients/
│   ├── geo42/
│   │   ├── whitelabel.config.js
│   │   └── template: "marketing-site"  # NEW: specify template
└── ...
```

---

### 2. MagUpSite is NOT the Source of Truth

**Wrong Mental Model:**
- "Let's update MagUpSite's homepage"
- "MagUpSite needs a new feature"
- "MagUpSite's design system..."

**Correct Mental Model:**
- "Let's update the **marketing-site template** in DeckSiteAgent"
- "The **marketing-site template** needs a new feature"
- "The **whitelabel config** for GEO 42 needs updating"

**Implication:**
- Never edit files in `dist/` (they're generated)
- Edit templates in `src/`
- Edit client-specific content in `clients/geo42/`
- Regenerate with `npm run pipeline -- --client geo42`

---

### 3. Phase 0 Work Lives in DeckSiteAgent

The 56 fixes in the master plan's Phase 0 are **template improvements**, not MagUpSite-specific work.

**Accessibility fixes** → improve `src/` templates so ALL generated sites are accessible
**Brand consistency** → improve whitelabel config system so ALL clients get consistent output
**Content improvements** → improve content extraction and merge logic
**Technical debt** → improve build pipeline and tooling

**This means:**
- Fix it once in DeckSiteAgent
- Every client benefits (GEO 42, Client Alpha, Client Beta, etc.)
- MagUpSite automatically improves on next regeneration

---

## UPDATED PHASE DEFINITIONS

### Phase 0: Foundation (Template System Polish)
**Goal:** Make DeckSiteAgent's marketing-site template production-ready for ANY client

**Work:**
1. Audit `src/` templates for GEO 42 hardcoding → remove
2. Implement accessibility fixes (apply to templates, not output)
3. Enhance whitelabel config (more brand tokens)
4. Improve content extraction (better PDF parsing)
5. Polish merge logic (smarter content-design synthesis)
6. Add multi-client support (`clients/` directory structure)

**Output:** DeckSiteAgent v1.0 — ready to generate client sites

---

### Phase 1: Horizon 1 (Autonomous Generation)
**Goal:** DeckSiteAgent generates complete sites/decks with minimal input

**Current State:**
- ✅ Semi-autonomous (pipeline runs end-to-end)
- ❌ Requires curated PDF input
- ❌ Manual merge.js edits often needed
- ❌ Limited persona orchestration

**Target State:**
- ✅ Fully autonomous (minimal human intervention)
- ✅ Intelligent data enrichment (scrape web for missing data)
- ✅ Self-correcting merge (personas collaborate to resolve conflicts)
- ✅ Quality gates enforce standards automatically

**Work:**
1. **Input layer:** Web scraping, API integrations, data enrichment
2. **Generation layer:** Persona orchestration, template selection, content optimization
3. **Output layer:** Multi-format export (PDF, PPTX, Google Slides), QA automation

---

### Phase 2: Horizon 2 (Autonomous Pipeline)
**Goal:** End-to-end automation from trigger to deployed site

**Example Flow:**
1. CRM event: "Deal moved to 'Qualified Lead' stage"
2. Trigger: DeckSiteAgent webhook fires
3. Data collection: Pull company data from Clearbit, Crunchbase, LinkedIn
4. Generation: Run pipeline with `pitch-deck` template
5. Review: Automated QA checks (persona audits)
6. Delivery: Email deck to sales rep, log in CRM
7. Feedback: Track opens, views, conversions

**Work:**
1. **Integration layer:** CRM webhooks, data source APIs
2. **Orchestration:** Job queue, retry logic, state machine
3. **Delivery:** Email, CRM updates, analytics

---

### Phase 3: Horizon 3 (Platform Launch)
**Goal:** DeckSiteAgent becomes a SaaS product (GEO 42 Platform)

**Architecture:**
- Multi-tenant (each customer gets isolated workspace)
- White-labeled (each customer can customize branding)
- Usage-based billing (per deck generated, per site deployed)
- API + webhooks (developers can integrate)

**Work:**
1. **Productization:** Multi-tenancy, user management, billing
2. **Scalability:** Kubernetes, auto-scaling, 99.9% SLA
3. **Go-to-market:** Marketing site (ironically, generate it with DeckSiteAgent!), sales process
4. **Expansion:** Marketplace (community templates), API ecosystem

---

## DECISION: REPOSITORY STRUCTURE

### Option A: Monorepo (Current)
```
DeckSiteAgent/
├── src/                    # Templates
├── clients/                # Client workspaces (NEW)
│   └── geo42/              # MagUpSite lives here
├── personas/               # Shared personas
├── scripts/                # Pipeline scripts
└── package.json
```

**Pros:**
- Single codebase, easy to coordinate changes
- Shared personas and scripts
- Simple CI/CD (one build)

**Cons:**
- Client data mixed with engine code
- Harder to open-source the engine
- Git history cluttered with client-specific commits

### Option B: Split Repos (Future)
```
DeckSiteAgent/              # Engine only
├── src/templates/          # Template variants
├── personas/               # Personas
├── scripts/                # Pipeline
└── package.json

DeckSiteAgent-Clients/      # Client workspaces
├── geo42/
├── client-alpha/
└── client-beta/

DeckSiteAgent-Templates/    # Community templates (optional)
├── marketing-site/
├── pitch-deck/
└── board-deck/
```

**Pros:**
- Clean separation of concerns
- Engine can be open-sourced
- Clients can be private
- Cleaner git history

**Cons:**
- Coordination overhead (3 repos)
- More complex CI/CD
- Versioning dependencies

### Recommendation: Start with Option A, migrate to Option B at Phase 3

**Phase 0-2:** Monorepo (move fast, iterate quickly)
**Phase 3:** Split repos (prepare for open-source + SaaS)

---

## UPDATED SEPARATION STRATEGY

### DeckSiteAgent Owns:
1. ✅ **Template system** (`src/` and future `templates/`)
2. ✅ **Pipeline scripts** (`scripts/extract-pdf.js`, `scripts/merge.js`, etc.)
3. ✅ **Persona system** (`personas/` — 11 expert agents)
4. ✅ **Configuration schema** (what goes in `whitelabel.config.js`)
5. ✅ **Build tooling** (Eleventy, Tailwind, linters, CI/CD)
6. ✅ **Quality gates** (audit system, persona reviews)

### MagUpSite Owns (as a client workspace):
1. ✅ **Brand configuration** (`clients/geo42/whitelabel.config.js`)
2. ✅ **Source materials** (`clients/geo42/source-pdf/`)
3. ✅ **Client-specific content** (`clients/geo42/data/pageContent.json`)
4. ✅ **Deployment config** (GitHub Pages URL)
5. ✅ **Custom overrides** (if needed, `clients/geo42/overrides/`)

### Neither Owns (Generated at Build Time):
1. ❌ `dist/` — generated output (never commit)
2. ❌ `data/merged-blueprint.json` — intermediate pipeline artifact
3. ❌ `src/css/style.css` — compiled Tailwind output

---

## ACTION ITEMS

### Immediate (This Week)
1. **Audit templates for GEO 42 hardcoding**
   - [ ] Search `src/**/*.njk` for "GEO 42", "Generative Engine Optimization", etc.
   - [ ] Move all content to `whitelabel.config.js` or `pageContent.json`
   - [ ] Update templates to use variables

2. **Create `clients/` directory structure**
   - [ ] Move current config to `clients/geo42/`
   - [ ] Update build scripts to accept `--client` flag
   - [ ] Update README with new structure

3. **Update MASTER-PLAN.md**
   - [ ] Reframe Phase 0 as "template improvements" not "MagUpSite fixes"
   - [ ] Add multi-client support to Phase 1 roadmap
   - [ ] Clarify architectural principles

### Short-Term (Next 2 Weeks)
4. **Test multi-client workflow**
   - [ ] Create dummy `clients/test-client/` workspace
   - [ ] Run pipeline for both geo42 and test-client
   - [ ] Verify clean separation (no cross-contamination)

5. **Document template customization**
   - [ ] Create `docs/template-customization.md`
   - [ ] Explain whitelabel config options
   - [ ] Provide examples of overrides

### Medium-Term (Next 4 Weeks)
6. **Extract template variants**
   - [ ] Create `templates/marketing-site/` (current default)
   - [ ] Start `templates/pitch-deck/` (Phase 1 work)
   - [ ] Update pipeline to support template selection

7. **Build client onboarding**
   - [ ] Create client intake form (what data we need)
   - [ ] Build automated client workspace creation
   - [ ] Write client-facing documentation

---

## UPDATED METRICS

### Phase 0 Success Metrics
- ❌ ~~"MagUpSite passes all accessibility tests"~~
- ✅ **"Marketing-site template generates accessible output for ANY client"**

- ❌ ~~"MagUpSite has 90+ Lighthouse scores"~~
- ✅ **"All template variants achieve 90+ Lighthouse scores"**

- ❌ ~~"MagUpSite converts at 5%+"~~
- ✅ **"Template system supports conversion optimization (configurable CTAs, A/B testing hooks)"**

### Phase 1 Success Metrics
- ✅ **Generate client-ready output for 3+ different companies (not just GEO 42)**
- ✅ **90%+ client acceptance rate (minimal revisions)**
- ✅ **<5 minute generation time (any template, any client)**

### Phase 2 Success Metrics
- ✅ **Support 10+ concurrent clients (multi-tenant ready)**
- ✅ **80%+ zero-touch generation (no human intervention)**
- ✅ **<10 minute end-to-end (trigger → deployed site)**

### Phase 3 Success Metrics
- ✅ **100 paying customers (SaaS revenue)**
- ✅ **$50K MRR (sustainable business)**
- ✅ **<5% monthly churn (product-market fit)**

---

## FINAL CLARITY

**What is DeckSiteAgent?**
A white-label content generation engine that transforms input materials (PDFs, data, URLs) into professional output (websites, decks, presentations) using an 11-persona quality control system.

**What is MagUpSite?**
The first client site generated by DeckSiteAgent — a proof-of-concept that validates the engine works and showcases the GEO 42 methodology.

**What is GEO 42 Platform?**
The future SaaS product (Phase 3) where DeckSiteAgent becomes a multi-tenant, self-service platform that anyone can use to generate professional content.

**Key Insight:**
We're not building a marketing site. We're building a factory that makes marketing sites (and decks, and presentations, and more). MagUpSite just happens to be the first product off the assembly line.

---

## CHANGELOG

### 2026-02-11 — v1.0.0
- Initial architecture clarity document
- Defined correct DeckSiteAgent ↔ MagUpSite relationship
- Proposed multi-client directory structure
- Updated phase definitions to reflect reusability focus
- Added action items for template generalization

---

**END OF ARCHITECTURE CLARITY**
